<p-messages [value]="msgs"></p-messages>
<p-confirmDialog width="400"></p-confirmDialog>
<div *ngIf="fstudy">
    <div class="row">
        <div class="col-md-12">
            <div class="header">
                <h4 class="title">{{header}}</h4>
            </div>
        </div>
    </div>
  <form  (ngSubmit)="f.form.valid && !wrongCity && !wrongInstitute && onSubmit()" #f="ngForm" novalidate>
    <div class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid">
        <div class="ui-grid-row">
          <div class="ui-grid-col-6">
            <label for="nivelEstudio">{{'EMPLOYEES.LBL_NIVELESTUDIOS' | translate}}</label>
            <p-dropdown name="nivelEstudio" id="nivelEstudio" #nivelEstudio="ngModel" required="true"
                        [autoWidth]="false" [(ngModel)]="fstudy.idNivelEstudio" [options]="studyLevelList"></p-dropdown>
            <div class="ui-message ui-messages-error ui-corner-all"  *ngIf="f.submitted && !nivelEstudio.valid">
              {{'EMPLOYEES.LBL_NIVELESTUDIOS' | translate}} {{'LBL_REQUERIDO' | translate}}
            </div>
          </div>
          <div class="ui-grid-col-6">
            <label for="areaEstudio">{{'EMPLOYEES.LBL_AREAESTUDIOS' | translate}}</label>
            <p-dropdown name="areaEstudio" id="areaEstudio" #areaEstudio="ngModel" required="true"
                        [autoWidth]="false" [(ngModel)]="fstudy.idAreaEstudio" [options]="studyAreaList"></p-dropdown>
            <div class="ui-message ui-messages-error ui-corner-all"  *ngIf="f.submitted && !areaEstudio.valid">
              {{'EMPLOYEES.LBL_AREAESTUDIOS' | translate}} {{'LBL_REQUERIDO' | translate}}
            </div>
          </div>
        </div>
        <div class="ui-grid-row">
          <div class="form-group col-md-12">
            <label for="titulo">{{'EMPLOYEES.LBL_TITULO' | translate}}</label>
            <input type="text" pInputText name="titulo" id="titulo"  #titulo="ngModel" required="true"
                   [(ngModel)]="fstudy.tituloEstudio"  />
            <div class="ui-message ui-messages-error ui-corner-all" *ngIf="f.submitted && !titulo.valid">
              {{'EMPLOYEES.LBL_TITULO' | translate}} {{'LBL_REQUERIDO' | translate}}
            </div>
          </div>
        </div>
        <div class="ui-grid-row">
          <div class="ui-grid-col-6">
            <label for="institucion">{{'EMPLOYEES.LBL_INSTITUCION' | translate}}</label>
            <p-autoComplete placeholder="Buscar institucion" field="nombre" #institucion="ngModel"
                            name="institucion" id="institucion" [required]="otraInstitucion.value === undefined || otraInstitucion.value === ''"
                            [(ngModel)]="selectedInstitute" [suggestions]="instituteList"
                            (completeMethod)="instituteSearch($event)" (onSelect)="captureInstituteId($event)" >
            </p-autoComplete>
            <div class="ui-message ui-messages-error ui-corner-all" *ngIf="f.submitted && wrongInstitute && (otraInstitucion.value === undefined || otraInstitucion.value === '')">
              {{'EMPLOYEES.LBL_INSTITUCION' | translate}} {{'LBL_REQUERIDO' | translate}}
            </div>
          </div>
          <div class="ui-grid-col-6">
            <label for="otraInstitucion">{{'EMPLOYEES.LBL_OTRAINSTITUCION' | translate}}</label>
            <input type="text" pInputText name="otraInstitucion" id="otraInstitucion"  #otraInstitucion="ngModel" (change)="removeInstitute()"
                   [(ngModel)]="fstudy.otraInstitucion" [required]="institucion.value === undefined || institucion.value === ''" />
            <div class="ui-message ui-messages-error ui-corner-all" *ngIf="f.submitted && !otraInstitucion.valid">
              {{'EMPLOYEES.LBL_OTRAINSTITUCION' | translate}} {{'LBL_REQUERIDO' | translate}}
            </div>
          </div>
        </div>
        <div class="ui-grid-row">
          <div class="ui-grid-col-6">
            <label for="ciudad">{{ 'LBL_CIUDAD' | translate }}</label>
            <p-autoComplete placeholder="Buscar ciudad" field="camino" #ciudad="ngModel" name="ciudad" id="ciudad"
                            [(ngModel)]="selectedCity" [suggestions]="cityList" required="true"
                            (completeMethod)="citySearch($event)" (onSelect)="captureCityId($event)" >
            </p-autoComplete>
            <div class="ui-message ui-messages-error ui-corner-all" *ngIf="f.submitted && wrongCity">
              {{ 'LBL_CIUDAD' | translate }} {{'LBL_REQUERIDO' | translate}}
            </div>
          </div>
          <div class="ui-grid-col-6">
            <label for="estadoEstudio">{{'EMPLOYEES.LBL_ESTADOS' | translate}}</label>
            <p-dropdown name="estadoEstudio" id="estadoEstudio" #estadoEstudio="ngModel" required="true" (onChange)="updateEnd()"
                        [autoWidth]="false" [(ngModel)]="fstudy.idEstado" [options]="studyStateList"></p-dropdown>
            <div class="ui-message ui-messages-error ui-corner-all" *ngIf="f.submitted && !estadoEstudio.valid">
              {{'EMPLOYEES.LBL_ESTADOS' | translate}} {{'LBL_REQUERIDO' | translate}}
            </div>
          </div>
        </div>
        <div class="ui-grid-row">
          <div class="ui-grid-col-6">
            <label for="ingreso">{{'EMPLOYEES.LBL_INGRESO' | translate}}</label>
            <p-calendar id="ingreso" name="ingreso"  [showIcon]="true"
                        [yearNavigator]="true" [yearRange]="range" [locale]="es" readonlyInput="true" [maxDate]="maxDate"
                        dataType="date" (onSelect)="onSelectBegin($event)" #ingreso="ngModel" required="true"
                        [(ngModel)]="fstudy.fechaIngresa"></p-calendar>
            <div class="ui-message ui-messages-error ui-corner-all" *ngIf="f.submitted && !ingreso.valid">
              {{'EMPLOYEES.LBL_INGRESO' | translate}} {{'LBL_REQUERIDO' | translate}}
            </div>
          </div>

          <div class="ui-grid-col-6"  *ngIf="(estadoEstudio.value == idEstadoEstudioFinalizado) && (ingreso.value !== undefined)">
            <label for="fechaTermina">{{'EMPLOYEES.LBL_FINALIZACION' | translate}} </label>
            <p-calendar id="fechaTermina" name="fechaTermina"  [showIcon]="true"
                        [yearNavigator]="true" [yearRange]="range" [locale]="es" readonlyInput="true" [minDate]="minDate" [maxDate]="maxDateFinal"
                        dataType="date" (onSelect)="onSelectEnd($event)" #fechaTermina="ngModel" [required]="estadoEstudio.value == idEstadoEstudioFinalizado"
                        [(ngModel)]="fstudy.fechaTermina"></p-calendar>
            <div class="ui-message ui-messages-error ui-corner-all" *ngIf="f.submitted && !fechaTermina.valid">
              {{'EMPLOYEES.LBL_FINALIZACION' | translate}} {{'LBL_REQUERIDO' | translate}}
            </div>
          </div>

           <!--<div class="ui-grid-col-6">-->
              <!--<label >{{'LBL_ADJUNTAR' | translate}} </label>-->
              <!--<p-fileUpload  name="files" url="http://localhost:5556/assets/upload/upload.html"-->
                            <!--auto="auto" (onUpload)="onUpload($event)" >-->
              <!--</p-fileUpload>-->
           <!--</div>-->

        </div>

        <div class="ui-grid-row form-footer-buttons">
          <div class="ui-grid-col-4"></div>
          <div class="ui-grid-col-1">
            <a (click)="goBack()" class="cancelar">{{ 'BTN_CANCELAR' | translate }}</a>
          </div>
          <div class="ui-grid-col-2">
            <button icon="fa-plus" label="{{'BTN_GUARDAR' | translate}}" type="submit" pButton></button>
          </div>
          <div class="ui-grid-col-5"></div>
        </div>
    </div>
  </form>


</div>
