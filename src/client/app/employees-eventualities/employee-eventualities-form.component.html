<p-messages [value]="msgs"></p-messages>
<p-confirmDialog width="400" #cd>
	<p-footer>
		<button type="button" pButton icon="fa-close" label="{{'BTN_NO' | translate }}" (click)="cd.reject()"></button>
		<button type="button" pButton icon="fa-check" label="{{'BTN_SI' | translate }}" (click)="cd.accept()"></button>
	</p-footer>
</p-confirmDialog>
<div class="col-md-10 col-md-offset-1">
	<form (ngSubmit)="f.valid && onSubmit()" #f="ngForm" novalidate id="formulario">
		<div class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid">
			<div class="ui-grid-row">
				<div class="ui-grid-col-6" *ngIf="showField()">
					<label for="idTipoNovedad">{{ 'DOCMANAGMENT.LBL_TIPO' | translate }}</label>
					<p-dropdown id="idTipoNovedad" name="idTipoNovedad" required="true"
					            [options]="listTypeDoc" [autoWidth]="false"
					            [(ngModel)]="employeeEventuality.idTipoNovedad"
					            #idTipoNov="ngModel"
					></p-dropdown>
					<div class="ui-message ui-messages-error ui-corner-all"
					     *ngIf="f.submitted && !idTipoNov.valid">
						<i class="fa fa-close"></i>
						{{ 'DOCMANAGMENT.LBL_TIPO' | translate }} {{ 'LBL_REQUERIDO' | translate }}
					</div>
				</div>
				<div class="ui-grid-col-6" *ngIf="showField()">
					<label for="idNovedad">{{ 'DOCMANAGMENT.LBL_TIPO' | translate }}</label>
					<p-dropdown id="idNovedad" name="idNovedad" required="true"
					            [options]="listTypeDoc" [autoWidth]="false"
					            [(ngModel)]="employeeEventuality.idNovedad"
					            #idNov="ngModel"
					></p-dropdown>
					<div class="ui-message ui-messages-error ui-corner-all"
					     *ngIf="f.submitted && !idNov.valid">
						<i class="fa fa-close"></i>
						{{ 'DOCMANAGMENT.LBL_TIPO' | translate }} {{ 'LBL_REQUERIDO' | translate }}
					</div>
				</div>
			</div>
			<div class="ui-grid-row">
				<div class="ui-grid-col-6" *ngIf="showField()">
					<label for="fechaInicio">{{ 'DOCMANAGMENT.LBL_TIPO' | translate }}</label>
					<p-calendar id="fechaInicio" name="fechaInicio" #fechaIni="ngModel" [showIcon]="true"
					            [minDate]="minDateInicio" [monthNavigator]="true" [yearNavigator]="true"
					            [locale]="es" readonlyInput="readonlyInput"
					            dataType="date" [(ngModel)]="employeeEventuality.fechaInicio" [showTime]="true"
					            dateFormat="yy'-'mm'-'dd"></p-calendar>
					<div class="ui-message ui-messages-error ui-corner-all" *ngIf="f.submitted && !fechaIni.valid">
						<i class="fa fa-close"></i>
						{{'PROCESOSELECCION.LBL_FECHA' | translate }} {{'LBL_REQUERIDO' | translate }}
					</div>
				</div>
				<div class="ui-grid-col-6" *ngIf="showField()">
					<label for="fechaFinal">{{ 'DOCMANAGMENT.LBL_TIPO' | translate }}</label>
					<p-calendar id="fechaFinal" name="fechaFinal" #fechaFin="ngModel" [showIcon]="true"
					            [minDate]="minDateFin" [monthNavigator]="true" [yearNavigator]="true"
					            [locale]="es" readonlyInput="readonlyInput"
					            dataType="date" [(ngModel)]="employeeEventuality.fechaFinal" [showTime]="true"
					            dateFormat="yy'-'mm'-'dd"></p-calendar>
					<div class="ui-message ui-messages-error ui-corner-all" *ngIf="f.submitted && !fechaFin.valid">
						<i class="fa fa-close"></i>
						{{'PROCESOSELECCION.LBL_FECHA' | translate }} {{'LBL_REQUERIDO' | translate }}
					</div>
				</div>
			</div>
			<div class="ui-grid-row">
				<div class="ui-grid-col-12" *ngIf="showField()">
					<label for="observacion">* {{'PROCESOSELECCION.LBL_OBSERVACIONES' | translate }}</label>
					<textarea id="observacion" name="observacion" pInputTextarea rows="4" cols="35" #decrip="ngModel"
					          [(ngModel)]="employeeEventuality.descripcion" required="true" class="form-control"
					          maxlength="500"></textarea>
					<div class="ui-message ui-messages-error ui-corner-all" *ngIf="f.submitted && !decrip.valid">
						<i class="fa fa-close"></i>
						{{'PROCESOSELECCION.LBL_OBSERVACIONES' | translate }} {{'LBL_REQUERIDO' | translate }}
					</div>
				</div>
			</div>
			<div class="ui-grid-row">
				<div class="ui-grid-col-6">
					<label>{{'EMPLOYEES.LBL_DIAGNOSTICO' | translate }}</label>
					<p-autoComplete placeholder="Buscar diagnÃ³stico" field="label" name="diagnostico" id="diagnostico"
					                [(ngModel)]="employeeEventuality.idTipoNovedad"
					                #diagnostico="ngModel" [suggestions]="diagnosticList"
					                (completeMethod)="diagnosticSearch($event)" (onSelect)="captureDiagnosticId($event)">
					</p-autoComplete>
					<div class="ui-message ui-messages-error ui-corner-all" *ngIf="f.submitted && wrongDiagnostic">
						<i class="fa fa-close"></i>{{'EMPLOYEES.LBL_DIAGNOSTICO' | translate}} {{'LBL_REQUERIDO' | translate}}
					</div>
				</div>
				<div class="ui-grid-col-6">
					<label for="reemplazado">{{ 'DOCMANAGMENT.LBL_TIPO' | translate }}</label>
					<p-dropdown id="reemplazado" name="reemplazado" required="true"
					            [options]="listTypeDoc" [autoWidth]="false"
					            [(ngModel)]="employeeEventuality.idTipoNovedad"
					            #idReempla="ngModel"
					></p-dropdown>
					<div class="ui-message ui-messages-error ui-corner-all"
					     *ngIf="f.submitted && !idReempla.valid">
						<i class="fa fa-close"></i>
						{{ 'DOCMANAGMENT.LBL_TIPO' | translate }} {{ 'LBL_REQUERIDO' | translate }}
					</div>
				</div>
			</div>
			<div class="ui-grid-row">
				<div class="ui-grid-col-6" >
					<label>{{'LBL_ADJUNTAR' | translate}} </label>
					<div *ngIf="employeeEventuality.idAdjunto != null" class="btn-group" role="group" style="display: block;">
						<a class="btn btn-default" style="max-width: 87%; overflow: hidden;" (click)="downloadFile(employeeEventuality.idAdjunto)">
							<i class="fa fa-file-o" aria-hidden="true"></i>
							{{dataUploadArchivo}}
						</a>
						<a class="btn btn-danger" (click)="uploadAgain(false)">
							<i class="fa fa-times" aria-hidden="true"></i>
						</a>
					</div>
					<p-fileUpload *ngIf="employeeEventuality.idAdjunto == null" name="file" url="{{svcThUrl}}" auto="true" class="upload-avatar"
					              chooseLabel="{{'LBL_ADJUNTAR' | translate}}"
					              (onBeforeSend)="onBeforeSend($event)"
					              (onSelect)="onSelect($event, $event.files)"
					              (onUpload)="uploadingOk($event)"
					              maxFileSize="{{fsize}}" accept="{{ftype}}">
					</p-fileUpload>
					<div class="ui-message ui-messages-error ui-corner-all"
					     *ngIf="f.submitted && employeeEventuality.idAdjunto == null">
						<i class="fa fa-close"></i>
						{{ 'DOCMANAGMENT.LBL_ADJUNTO' | translate }} {{ 'LBL_REQUERIDO' | translate }}
					</div>
				</div>
			</div>
			<div class="ui-grid-row form-footer-buttons">
				<div class="ui-grid-col-4"></div>
				<div class="ui-grid-col-1">
					<a (click)="goBack((f.dirty === true))" class="cancelar">{{'BTN_CANCELAR' | translate }}</a>
				</div>
				<div class="ui-grid-col-2">
					<button pButton icon="fa-plus" label="{{'BTN_GUARDAR' | translate }}" type="submit"></button>
				</div>
				<div class="ui-grid-col-5"></div>
			</div>
		</div>
	</form>
</div>
